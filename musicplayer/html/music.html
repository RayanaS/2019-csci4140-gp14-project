<script type="text/javascript" src="../js/sidebar.js"></script>

<script language="JavaScript" type="text/javascript" src="../node_modules/p5/lib/p5.js"></script>
<script type="text/javascript" src="../node_modules/p5/lib/addons/p5.sound.js"></script>

<style>
.song {
    background: white;
    border-radius: 13px;
}

.song h1 {
    padding: 0.5em 0.8em;
}

.button {
    background-color: transparent;
    border: none;
    display: inline;
    margin: 1em 1em;
}

.myslider {
    -webkit-appearance: none;
    height: 6px;
    border-radius: 4px;
    background: #0b0b0b;
    display: inline;
    -webkit-transition: .2s;
    transition: background .2s;
}
.myslider:hover {
    background: #2990c9;
}

.progressBar {
    margin: 1em 2.5em 1em 2.5em;
    width: 80%;
    height: 6px;
    border-radius: 4px;
    background: #e3e3e3;
    display: inline-block;
}

#progress {
    width: 5%;
    height: 7px;
    border-radius: 4px;
    background-color: #2ea1e1;
}

</style>

<div>
    <h1 style="padding: 0.3em 1em;">Song Player</h1>

    <div class="song">
      <h1>Through the night (Cafe)</h1>
        <div class="progressBar">
            <div id="progress"></div>
        </div>
      <div>
          <button class="button" onclick="togglePlaying();">
              <img id="img" src="../image/play.png" style="height: 40px; width: auto" alt="Play/Pause"/>
          </button>
          <img src="../image/volume.png" style="height: 25px; width: auto; margin-right: 10px">
          <input type="range" class="myslider" min="0" max="100" value="100" id="volume" style="width: 20%">
      </div>
    </div>
</div>

<script>
    const { ipcRenderer } = require('electron');
    var song, noise, reverb, cVerb;

    var volume = document.getElementById("volume");
    var icon = document.getElementById("img");
    var progress = document.getElementById("progress");
    var play = "../image/play.png";
    var pause = "../image/pause.png";

    function preload() {
        song = loadSound("../audio/through-the-night.mp3");
        noise = loadSound("../audio/cafe.mp3");
        // noise = loadSound("../audio/rain.mp3");
        // noise.setVolume(0.35); // rain parameter

        cVerb = new p5.Convolver("../IMreverbs/Ruby Room.wav");
    }

    function setup() {
        reverb = new p5.Reverb();
        song.disconnect();

        // x second reverbTime, decayRate of x%
        reverb.process(song, 8, 52); // cafe effect
        /*
        HERE ^^^^
        I am wondering would the echo be too much if add cVerb effect also
         */

        //reverb.process(song, 2, 50); // rain parameter
        //reverb.process(song, 3, 30); // cafe parameter
        //cVerb.process(song);
    }

    function togglePlaying() {
        if (!song.isPlaying()) {
            song.play();
            icon.src = pause;
            noise.play();
        } else {
            song.pause();
            icon.src = play;
            noise.pause();
        }
    }

    volume.oninput = function () {
        song.setVolume(this.value / 100);
        noise.setVolume(this.value / 100);
    };

</script>

<script type="text/javascript" src="../js/sidebar2.js"></script>