<script type="text/javascript" src="../js/sidebar.js"></script>

<script language="JavaScript" type="text/javascript" src="../node_modules/p5/lib/p5.js"></script>
<script type="text/javascript" src="../node_modules/p5/lib/addons/p5.sound.js"></script>

<style>
.song {
    border: 3px#cccccc dashed;
}

.song h1 {
    padding: 0.5em;
}

.button {
    background-color: #ffffff;
    border: none;
    padding: 10px 25px;
    display: inline-block;
    margin: 1em 1em;
}

.myslider {
    -webkit-appearance: none;
    width: 30%;
    height: 6px;
    border-radius: 4px;
    background: #0b0b0b;
    display: inline-block;
    -webkit-transition: .2s;
    transition: background .2s;
}
.myslider:hover {
    background: #2990c9;
}

</style>

<div>
    <h1>Song Player</h1>

    <div class="song">
      <h1>Through the night (cafe)</h1>
      <div>
          <button id="playbtn" class="button" onclick="togglePlaying();">
              <img src="../image/play.png" style="height: 30px; width: auto"/>
          </button>
          Volume <input type="range" class="myslider" min="0" max="100" value="100" id="volume">
      </div>
    </div>
</div>

<script>
    const { ipcRenderer } = require('electron');
    var song, noise;
    var volume = document.getElementById("volume");
    var button = document;
    var reverb;
    var cVerb;

    function preload() {
        song = loadSound("../audio/through-the-night.mp3");
        // noise = loadSound("../audio/rain.mp3");
        // noise.setVolume(0.35); // rain parameter

        noise = loadSound("../audio/cafe.mp3");

        cVerb = new p5.Convolver("../IMreverbs/Ruby Room.wav");
    }

    function setup() {
        reverb = new p5.Reverb();
        song.disconnect(); // so we'll only hear reverb...

        // connect song to reverb, process w/
        // 3 second reverbTime, decayRate of 2%
        // reverb.process(song, 2, 50); // rain parameter

        // reverb.process(song, 3, 30); // cafe parameter

        cVerb.process(song);
        
    }

    function togglePlaying() {
        if (!song.isPlaying()) {
            song.play();
            noise.play();
        } else {
            song.pause();
            noise.pause();
        }
        // if( document.getElementById("playbtn").src == "../image/play.png" ){
        //     document.getElementById("playbtn").src = "../image/pause.png";
        //     console.log("play png");
        // } 
        // else if( document.getElementById("playbtn").src == "../image/pause.png" ){
        //     document.getElementById("playbtn").src = "../image/play.png";
        // }
    }

    volume.oninput = function () {
        song.setVolume(this.value / 100);
        noise.setVolume(this.value / 100);
    }

</script>

<script type="text/javascript" src="../js/sidebar2.js"></script>