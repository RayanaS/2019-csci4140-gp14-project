<script type="text/javascript" src="../js/sidebar.js"></script>


<h1>Original Music</h1>
<hr>

<!-- file upload -->
        <div>
            <div style="text-align:center;">
                <input type="text" placeholder="Please select a file" id="actual-file" disabled="disabled"/>
                <input type="button" value="Choose a file" id="select-file"/>
            </div>
            <br><br>
            <!-- <textarea id="content-editor" rows="5"></textarea><br><br>
            <input type="button" id="save-changes" value="Save changes"/>
            <input type="button" id="delete-file" value="Delete file"/> -->
        </div>
        <hr>
<!--  -->
        <div>
            
                <div class="song">
                  <h1>Through the night (Cafe)</h1>
                    <div>
                      <button class="button" onclick="togglePlaying();">
                          <img id="img" src="../image/play.png" style="height: 40px; margin: 1em 1.5em 1em 0em" alt="Play/Pause"/>
                      </button>
                    </div>
                </div>
            
                <input type="file" id="file-uploader" data-target="file-uploader"/>
            </div>

<!-- script -->
        
        <script>
            // var remote = require('electron').remote;
            var app = require('electron').remote; 
            var dialog = app.dialog;
            var fs = require('fs');
                
            document.getElementById('select-file').addEventListener('click',function(){
                dialog.showOpenDialog(function (fileNames) {
                    if(fileNames === undefined){
                        console.log("No file selected");
                    }else{
                        document.getElementById("actual-file").value = fileNames[0];
                        readFile(fileNames[0]);
                        console.log(document.getElementById("actual-file").value);
                        preload(document.getElementById("actual-file").value);
                    }
                }); 
            },false);

            function readFile(filepath) {
                fs.readFile(filepath, 'utf-8', function (err, data) {
                    if(err){
                        alert("An error ocurred reading the file :" + err.message);
                        return;
                    }
                });
            }
        </script>

        <script language="JavaScript" type="text/javascript" src="../node_modules/p5/lib/p5.js"></script>
        <script type="text/javascript" src="../node_modules/p5/lib/addons/p5.sound.js"></script>

        <script>
            var song;

            function preload(filepath) {
                song = loadSound("../audio/music/through-the-night.mp3", loaded);
            }

            function togglePlaying() {
                if (!song.isPlaying()) {
                    song.play();
                    icon.src = pause;
                    noise.play();
                } else {
                    song.pause();
                    icon.src = play;
                    noise.pause();
                }
            }

        </script>

<script type="text/javascript" src="../js/sidebar2.js"></script>